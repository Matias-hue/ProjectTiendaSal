document.addEventListener("DOMContentLoaded",function(){console.log("JavaScript de Inventario cargado");const s=document.getElementById("btn-agregar"),n=document.getElementById("dialog-agregar"),m=document.getElementById("btn-cerrar"),o=document.getElementById("dialog-editar"),u=document.getElementById("btn-cerrar-editar"),r=document.getElementById("dialog-eliminar"),E=document.getElementById("btn-cerrar-eliminar"),i=document.getElementById("btn-confirmar-eliminar");if(s&&n&&m&&(s.addEventListener("click",function(){n.showModal()}),m.addEventListener("click",function(){n.close()})),n){const t=n.querySelector("form");if(t){const e=t.querySelector('button[type="submit"]');e&&t.addEventListener("submit",function(){e.disabled=!0,e.innerText="Creando..."})}}document.querySelectorAll(".btn-editar-tabla").forEach(t=>{t.addEventListener("click",function(){const e=this.getAttribute("data-id"),b=this.getAttribute("data-nombre"),l=this.getAttribute("data-tamaño"),a=this.getAttribute("data-precio"),d=this.getAttribute("data-stock");document.getElementById("edit-nombre").value=b,document.getElementById("edit-tamaño").value=l,document.getElementById("edit-precio").value=a,document.getElementById("edit-stock").value=d,o&&o.showModal();const f=document.getElementById("form-editar");f&&(f.action=`/productos/${e}`)})}),u&&o&&u.addEventListener("click",function(){o.close()});const c=document.getElementById("form-editar");if(c){const t=c.querySelector('button[type="submit"]');t&&c.addEventListener("submit",function(){t.disabled=!0,t.innerText="Editando..."})}const y=document.querySelectorAll(".btn-eliminar-tabla");let g;y.forEach(t=>{t.addEventListener("click",function(){var d;const l=((d=this.closest("tr").querySelectorAll("td")[1])==null?void 0:d.innerText)||"nombre no encontrado",a=document.getElementById("mensaje-eliminar");a&&(a.innerText=`¿Estás seguro de que deseas eliminar el producto "${l}"?`),r&&r.showModal(),g=this.getAttribute("data-id")})}),i&&i.addEventListener("click",function(){i.disabled=!0,i.innerText="Eliminando...",fetch(`/productos/${g}`,{method:"DELETE",headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content"),Accept:"application/json"}}).then(t=>{if(!t.ok)throw new Error(`Error del servidor: ${t.status}`);return t.json()}).then(t=>{console.log(t.message),location.reload()}).catch(t=>{console.error("Error:",t),alert("Hubo un problema con la eliminación: "+t.message)})}),E&&r&&E.addEventListener("click",function(){r.close()})});
