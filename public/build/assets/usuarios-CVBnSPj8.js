document.addEventListener("DOMContentLoaded",function(){console.log("JavaScript de Usuarios cargado");const n=document.getElementById("search"),c=document.getElementById("usuarios-table-body"),i=document.querySelector(".pagination"),d="/usuarios",u=n==null?void 0:n.form;let m=null;n&&n.addEventListener("input",function(){clearTimeout(m),m=setTimeout(()=>{const t=n.value.trim();s(t)},300)}),u&&u.addEventListener("submit",function(t){t.preventDefault();const o=n.value.trim();s(o)}),i&&i.addEventListener("click",function(t){t.preventDefault();const o=t.target.closest(".page-link");if(o&&!o.parentElement.classList.contains("disabled")){const l=o.getAttribute("href");s(null,l)}});function s(t="",o=null){const l=o||`${d}?search=${encodeURIComponent(t)}`;fetch(l,{headers:{"X-Requested-With":"XMLHttpRequest",Accept:"application/json"}}).then(e=>{if(!e.ok)throw new Error(`Error HTTP: ${e.status}`);return e.json()}).then(e=>{if(c.innerHTML="",e.data.length===0){c.innerHTML='<tr><td colspan="4" style="text-align:center;">No se encontraron usuarios</td></tr>';return}e.data.forEach(r=>{const a=document.createElement("tr"),p=document.createElement("td");p.textContent=r.id,a.appendChild(p);const f=document.createElement("td");f.textContent=r.name,a.appendChild(f);const h=document.createElement("td");h.textContent=r.role||"Usuario",a.appendChild(h);const E=document.createElement("td");E.innerHTML=`<a href="/usuarios/${r.id}/edit" class="btn-editar" aria-label="Editar usuario ${r.name}">Editar</a>`,a.appendChild(E),c.appendChild(a)}),i.innerHTML=e.links||"";const g=t?`${d}?search=${encodeURIComponent(t)}`:d;window.history.pushState({},"",g)}).catch(e=>{console.error("Error fetching users:",e),c.innerHTML='<tr><td colspan="4" style="text-align:center;">Error al cargar usuarios</td></tr>'})}});
