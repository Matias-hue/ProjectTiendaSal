import{a as v}from"./index-DtQ_HIrt.js";window.axios=v;window.axios.defaults.headers.common["X-Requested-With"]="XMLHttpRequest";document.addEventListener("DOMContentLoaded",function(){console.log("JavaScript de Inventario cargado");const d=document.getElementById("btn-agregar"),e=document.getElementById("dialog-agregar"),s=document.getElementById("btn-cerrar"),i=document.getElementById("dialog-editar"),E=document.getElementById("btn-cerrar-editar"),a=document.getElementById("dialog-eliminar"),c=document.getElementById("btn-cerrar-eliminar"),r=document.getElementById("btn-confirmar-eliminar");if(d&&e&&s&&(d.addEventListener("click",function(){e.showModal()}),s.addEventListener("click",function(){e.close()})),e){const n=e.querySelector("form");if(n){const f=n.querySelector('button[type="submit"]');f&&n.addEventListener("submit",function(){f.disabled=!0,f.innerText="Creando..."})}}document.querySelectorAll(".btn-editar-tabla").forEach(n=>{n.addEventListener("click",function(){const f=this.getAttribute("data-id"),t=this.getAttribute("data-nombre"),o=this.getAttribute("data-tamaño"),b=this.getAttribute("data-precio"),p=this.getAttribute("data-stock");document.getElementById("edit-nombre").value=t,document.getElementById("edit-tamaño").value=o,document.getElementById("edit-precio").value=b,document.getElementById("edit-stock").value=p,i&&i.showModal();const h=document.getElementById("form-editar");h&&(h.action=`/productos/${f}`)})}),E&&i&&E.addEventListener("click",function(){i.close()});const l=document.getElementById("form-editar");if(l){const n=l.querySelector('button[type="submit"]');n&&l.addEventListener("submit",function(){n.disabled=!0,n.innerText="Editando..."})}const u=document.querySelectorAll(".btn-eliminar-tabla");let m;u.forEach(n=>{n.addEventListener("click",function(){var p;const o=((p=this.closest("tr").querySelectorAll("td")[1])==null?void 0:p.innerText)||"nombre no encontrado",b=document.getElementById("mensaje-eliminar");b&&(b.innerText=`¿Estás seguro de que deseas eliminar el producto "${o}"?`),a&&a.showModal(),m=this.getAttribute("data-id")})}),r&&r.addEventListener("click",function(){r.disabled=!0,r.innerText="Eliminando...",fetch(`/productos/${m}`,{method:"DELETE",headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")}}).then(n=>{n.ok?location.reload():alert("Error al eliminar el producto.")}).catch(n=>{console.error("Error:",n),alert("Hubo un problema con la eliminación: "+n.message)})}),c&&a&&c.addEventListener("click",function(){a.close()})});document.addEventListener("DOMContentLoaded",function(){console.log("JavaScript de Pedidos cargado");const d=document.getElementById("dialog-completar"),e=document.getElementById("dialog-cancelar"),s=document.getElementById("dialog-error"),i=document.getElementById("btn-cerrar-completar"),E=document.getElementById("btn-cerrar-cancelar"),a=document.getElementById("btn-cerrar-error"),c=document.getElementById("btn-confirmar-completar"),r=document.getElementById("btn-confirmar-cancelar"),g=document.getElementById("mensaje-error");let l,u;function m(t){g.textContent=t,s.showModal()}document.querySelectorAll(".btn-completar").forEach(t=>{t.addEventListener("click",function(o){o.preventDefault(),l=this.getAttribute("data-id"),u=this.closest("tr"),d.showModal()})}),c.addEventListener("click",function(){c.disabled=!0,c.textContent="Procesando...",fetch(`/pedidos/${l}/complete`,{method:"PATCH",headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content"),Accept:"application/json","Content-Type":"application/json"}}).then(t=>t.json()).then(t=>{if(t.success){const o=u.querySelector(".status-cell");o.textContent="Completado";const b=u.querySelector("td:last-child");b.innerHTML="",d.close()}else m(t.error||"No se pudo completar el pedido.")}).catch(t=>{console.error("Error:",t),m("Hubo un problema: "+t.message)}).finally(()=>{c.disabled=!1,c.textContent="Sí"})}),i.addEventListener("click",function(){d.close()}),document.querySelectorAll(".btn-cancelar").forEach(t=>{t.addEventListener("click",function(o){o.preventDefault(),l=this.getAttribute("data-id"),u=this.closest("tr"),e.showModal()})}),r.addEventListener("click",function(){r.disabled=!0,r.textContent="Procesando...",fetch(`/pedidos/${l}/cancel`,{method:"PATCH",headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content"),Accept:"application/json","Content-Type":"application/json"}}).then(t=>t.json()).then(t=>{if(t.success){const o=u.querySelector(".status-cell");o.textContent="Cancelado";const b=u.querySelector("td:last-child");b.innerHTML="",e.close()}else m(t.error||"No se pudo cancelar el pedido.")}).catch(t=>{console.error("Error:",t),m("Hubo un problema: "+t.message)}).finally(()=>{r.disabled=!1,r.textContent="Sí"})}),E.addEventListener("click",function(){e.close()}),a.addEventListener("click",function(){s.close()})});document.addEventListener("DOMContentLoaded",function(){document.getElementById("search-registro").addEventListener("keypress",function(e){if(e.key==="Enter"){const s=e.target.value;window.location.href="/registro?search="+encodeURIComponent(s)}})});document.addEventListener("DOMContentLoaded",function(){const d=document.getElementById("ventasPorDiaChart").getContext("2d");new Chart(d,{type:"bar",data:{labels:window.chartLabels,datasets:[{label:"Productos Vendidos",data:window.chartData,backgroundColor:"rgba(54, 162, 235, 0.6)",borderColor:"rgba(54, 162, 235, 1)",borderWidth:1}]},options:{scales:{y:{beginAtZero:!0,title:{display:!0,text:"Cantidad Vendida"}},x:{title:{display:!0,text:"Día del Mes"}}}}});const e=document.getElementById("productoMasVendidoChart").getContext("2d");new Chart(e,{type:"doughnut",data:{labels:[window.productoMasVendido?window.productoMasVendido.nombre:"Sin datos","Otros"],datasets:[{data:[window.productoMasVendido?window.productoMasVendido.total_vendido:0,1],backgroundColor:["rgba(255, 99, 132, 0.6)","rgba(200, 200, 200, 0.3)"],borderColor:["rgba(255, 99, 132, 1)","rgba(200, 200, 200, 1)"],borderWidth:1}]},options:{plugins:{legend:{position:"bottom"},tooltip:{callbacks:{label:function(i){return i.label+": "+i.raw+" unidades"}}}}}});const s=document.getElementById("todosProductosChart").getContext("2d");new Chart(s,{type:"bar",data:{labels:window.productosLabels,datasets:[{label:"Cantidad Vendida",data:window.productosData,backgroundColor:"rgba(75, 192, 192, 0.6)",borderColor:"rgba(75, 192, 192, 1)",borderWidth:1}]},options:{scales:{y:{beginAtZero:!0,title:{display:!0,text:"Cantidad Vendida"}},x:{title:{display:!0,text:"Producto"}}},plugins:{legend:{display:!1}}}})});document.addEventListener("DOMContentLoaded",function(){console.log("JavaScript de Ubicación cargado")});document.addEventListener("DOMContentLoaded",function(){console.log("JavaScript de Usuarios cargado");const d=document.getElementById("search"),e=document.getElementById("usuarios-table-body"),s="/usuarios";if(d){let i=null;d.addEventListener("input",function(){clearTimeout(i),i=setTimeout(()=>{const E=d.value.trim();fetch(`${s}?search=`+encodeURIComponent(E),{headers:{"X-Requested-With":"XMLHttpRequest"}}).then(a=>{if(!a.ok)throw new Error("Network response was not ok");return a.json()}).then(a=>{if(e.innerHTML="",a.length===0){e.innerHTML='<tr><td colspan="3" style="text-align:center;">No se encontraron usuarios</td></tr>';return}a.forEach(c=>{const r=document.createElement("tr"),g=document.createElement("td");g.textContent=c.id,r.appendChild(g);const l=document.createElement("td");l.textContent=c.name,r.appendChild(l);const u=document.createElement("td");u.textContent=c.role?c.role:"Usuario",r.appendChild(u),e.appendChild(r)})}).catch(a=>{console.error("Error fetching users: ",a)})},300)})}});document.addEventListener("DOMContentLoaded",function(){const d=document.getElementById("btn-agregar"),e=document.getElementById("dialog-agregar"),s=document.getElementById("btn-cerrar"),i=document.getElementById("dialog-editar"),E=document.getElementById("btn-cerrar-editar"),a=document.getElementById("dialog-eliminar"),c=document.getElementById("btn-cerrar-eliminar"),r=document.getElementById("btn-confirmar-eliminar");d&&e&&s&&(d.addEventListener("click",function(){e.showModal()}),s.addEventListener("click",function(){e.close()}));const g=e.querySelector("form"),l=g.querySelector('button[type="submit"]');g&&l&&g.addEventListener("submit",function(){l.disabled=!0,l.innerText="Creando..."}),console.log(e),console.log(g),document.querySelectorAll(".btn-editar-tabla").forEach(o=>{o.addEventListener("click",function(){const b=this.getAttribute("data-id"),p=this.getAttribute("data-nombre"),h=this.getAttribute("data-tamaño"),y=this.getAttribute("data-precio"),C=this.getAttribute("data-stock");document.getElementById("edit-nombre").value=p,document.getElementById("edit-tamaño").value=h,document.getElementById("edit-precio").value=y,document.getElementById("edit-stock").value=C,i.showModal();const I=document.getElementById("form-editar");I.action=`/productos/${b}`})}),E&&E.addEventListener("click",function(){i.close()});const m=document.getElementById("form-editar"),n=m.querySelector('button[type="submit"]');m&&n&&m.addEventListener("submit",function(){n.disabled=!0,n.innerText="Editando..."});const f=document.querySelectorAll(".btn-eliminar-tabla");let t;f.forEach(o=>{o.addEventListener("click",function(){var y;const p=this.closest("tr").querySelectorAll("td");console.log(p);const h=((y=p[1])==null?void 0:y.innerText)||"nombre no encontrado";document.getElementById("mensaje-eliminar").innerText=`¿Estás seguro de que deseas eliminar el producto "${h}"?`,a.showModal(),t=this.getAttribute("data-id")})}),r.addEventListener("click",function(){r.disabled=!0,r.innerText="Eliminando...",fetch(`/productos/${t}`,{method:"DELETE",headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")}}).then(o=>{o.ok?location.reload():alert("Error al eliminar el producto.")}).catch(o=>{console.error("Error:",o),alert("Hubo un problema con la eliminación."+o.message)})}),c&&c.addEventListener("click",function(){a.close()})});
