import{a as B}from"./index-DtQ_HIrt.js";window.axios=B;window.axios.defaults.headers.common["X-Requested-With"]="XMLHttpRequest";document.addEventListener("DOMContentLoaded",function(){console.log("JavaScript de Inventario cargado");const d=document.getElementById("btn-agregar"),n=document.getElementById("dialog-agregar"),u=document.getElementById("btn-cerrar"),c=document.getElementById("dialog-editar"),E=document.getElementById("btn-cerrar-editar"),r=document.getElementById("dialog-eliminar"),l=document.getElementById("btn-cerrar-eliminar"),a=document.getElementById("btn-confirmar-eliminar");if(d&&n&&u&&(d.addEventListener("click",function(){n.showModal()}),u.addEventListener("click",function(){n.close()})),n){const e=n.querySelector("form");if(e){const o=e.querySelector('button[type="submit"]');o&&e.addEventListener("submit",function(){o.disabled=!0,o.innerText="Creando..."})}}document.querySelectorAll(".btn-editar-tabla").forEach(e=>{e.addEventListener("click",function(){const o=this.getAttribute("data-id"),t=this.getAttribute("data-nombre"),s=this.getAttribute("data-tamaño"),b=this.getAttribute("data-precio"),f=this.getAttribute("data-stock");document.getElementById("edit-nombre").value=t,document.getElementById("edit-tamaño").value=s,document.getElementById("edit-precio").value=b,document.getElementById("edit-stock").value=f,c&&c.showModal();const h=document.getElementById("form-editar");h&&(h.action=`/productos/${o}`)})}),E&&c&&E.addEventListener("click",function(){c.close()});const i=document.getElementById("form-editar");if(i){const e=i.querySelector('button[type="submit"]');e&&i.addEventListener("submit",function(){e.disabled=!0,e.innerText="Editando..."})}const m=document.querySelectorAll(".btn-eliminar-tabla");let g;m.forEach(e=>{e.addEventListener("click",function(){var f;const s=((f=this.closest("tr").querySelectorAll("td")[1])==null?void 0:f.innerText)||"nombre no encontrado",b=document.getElementById("mensaje-eliminar");b&&(b.innerText=`¿Estás seguro de que deseas eliminar el producto "${s}"?`),r&&r.showModal(),g=this.getAttribute("data-id")})}),a&&a.addEventListener("click",function(){a.disabled=!0,a.innerText="Eliminando...",fetch(`/productos/${g}`,{method:"DELETE",headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content"),Accept:"application/json"}}).then(e=>{if(!e.ok)throw new Error(`Error del servidor: ${e.status}`);return e.json()}).then(e=>{console.log(e.message),location.reload()}).catch(e=>{console.error("Error:",e),alert("Hubo un problema con la eliminación: "+e.message)})}),l&&r&&l.addEventListener("click",function(){r.close()})});document.addEventListener("DOMContentLoaded",function(){console.log("JavaScript de Pedidos cargado");const d=document.getElementById("dialog-completar"),n=document.getElementById("dialog-cancelar"),u=document.getElementById("dialog-error"),c=document.getElementById("btn-cerrar-completar"),E=document.getElementById("btn-cerrar-cancelar"),r=document.getElementById("btn-cerrar-error"),l=document.getElementById("btn-confirmar-completar"),a=document.getElementById("btn-confirmar-cancelar"),p=document.getElementById("mensaje-error");let i,m;function g(t){p.textContent=t,u.showModal()}document.querySelectorAll(".btn-completar").forEach(t=>{t.addEventListener("click",function(s){s.preventDefault(),i=this.getAttribute("data-id"),m=this.closest("tr"),d.showModal()})}),l.addEventListener("click",function(){l.disabled=!0,l.textContent="Procesando...",fetch(`/pedidos/${i}/complete`,{method:"PATCH",headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content"),Accept:"application/json","Content-Type":"application/json"}}).then(t=>t.json()).then(t=>{if(t.success){const s=m.querySelector(".status-cell");s.textContent="Completado";const b=m.querySelector("td:last-child");b.innerHTML="",d.close()}else g(t.error||"No se pudo completar el pedido.")}).catch(t=>{console.error("Error:",t),g("Hubo un problema: "+t.message)}).finally(()=>{l.disabled=!1,l.textContent="Sí"})}),c.addEventListener("click",function(){d.close()}),document.querySelectorAll(".btn-cancelar").forEach(t=>{t.addEventListener("click",function(s){s.preventDefault(),i=this.getAttribute("data-id"),m=this.closest("tr"),n.showModal()})}),a.addEventListener("click",function(){a.disabled=!0,a.textContent="Procesando...",fetch(`/pedidos/${i}/cancel`,{method:"PATCH",headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content"),Accept:"application/json","Content-Type":"application/json"}}).then(t=>t.json()).then(t=>{if(t.success){const s=m.querySelector(".status-cell");s.textContent="Cancelado";const b=m.querySelector("td:last-child");b.innerHTML="",n.close()}else g(t.error||"No se pudo cancelar el pedido.")}).catch(t=>{console.error("Error:",t),g("Hubo un problema: "+t.message)}).finally(()=>{a.disabled=!1,a.textContent="Sí"})}),E.addEventListener("click",function(){n.close()}),r.addEventListener("click",function(){u.close()})});document.addEventListener("DOMContentLoaded",function(){document.getElementById("search-registro").addEventListener("keypress",function(n){if(n.key==="Enter"){const u=n.target.value;window.location.href="/registro?search="+encodeURIComponent(u)}})});document.addEventListener("DOMContentLoaded",function(){const d=document.getElementById("ventasPorDiaChart").getContext("2d");new Chart(d,{type:"bar",data:{labels:window.chartLabels,datasets:[{label:"Productos Vendidos",data:window.chartData,backgroundColor:"rgba(54, 162, 235, 0.6)",borderColor:"rgba(54, 162, 235, 1)",borderWidth:1}]},options:{scales:{y:{beginAtZero:!0,title:{display:!0,text:"Cantidad Vendida"}},x:{title:{display:!0,text:"Día del Mes"}}}}});const n=document.getElementById("productoMasVendidoChart").getContext("2d");new Chart(n,{type:"doughnut",data:{labels:[window.productoMasVendido?window.productoMasVendido.nombre:"Sin datos","Otros"],datasets:[{data:[window.productoMasVendido?window.productoMasVendido.total_vendido:0,1],backgroundColor:["rgba(255, 99, 132, 0.6)","rgba(200, 200, 200, 0.3)"],borderColor:["rgba(255, 99, 132, 1)","rgba(200, 200, 200, 1)"],borderWidth:1}]},options:{plugins:{legend:{position:"bottom"},tooltip:{callbacks:{label:function(c){return c.label+": "+c.raw+" unidades"}}}}}});const u=document.getElementById("todosProductosChart").getContext("2d");new Chart(u,{type:"bar",data:{labels:window.productosLabels,datasets:[{label:"Cantidad Vendida",data:window.productosData,backgroundColor:"rgba(75, 192, 192, 0.6)",borderColor:"rgba(75, 192, 192, 1)",borderWidth:1}]},options:{scales:{y:{beginAtZero:!0,title:{display:!0,text:"Cantidad Vendida"}},x:{title:{display:!0,text:"Producto"}}},plugins:{legend:{display:!1}}}})});document.addEventListener("DOMContentLoaded",function(){console.log("JavaScript de Ubicación cargado")});document.addEventListener("DOMContentLoaded",function(){console.log("JavaScript de Usuarios cargado");const d=document.getElementById("search"),n=document.getElementById("usuarios-table-body"),u="/usuarios";if(d){let c=null;d.addEventListener("input",function(){clearTimeout(c),c=setTimeout(()=>{const E=d.value.trim();fetch(`${u}?search=`+encodeURIComponent(E),{headers:{"X-Requested-With":"XMLHttpRequest"}}).then(r=>{if(!r.ok)throw new Error("Network response was not ok");return r.json()}).then(r=>{if(n.innerHTML="",r.length===0){n.innerHTML='<tr><td colspan="3" style="text-align:center;">No se encontraron usuarios</td></tr>';return}r.forEach(l=>{const a=document.createElement("tr"),p=document.createElement("td");p.textContent=l.id,a.appendChild(p);const i=document.createElement("td");i.textContent=l.name,a.appendChild(i);const m=document.createElement("td");m.textContent=l.role?l.role:"Usuario",a.appendChild(m),n.appendChild(a)})}).catch(r=>{console.error("Error fetching users: ",r)})},300)})}});document.addEventListener("DOMContentLoaded",function(){const d=document.getElementById("btn-agregar"),n=document.getElementById("dialog-agregar"),u=document.getElementById("btn-cerrar");if(d&&n&&u){d.addEventListener("click",()=>n.showModal()),u.addEventListener("click",()=>n.close());const e=n.querySelector("form");if(e){const o=e.querySelector('button[type="submit"]');o&&e.addEventListener("submit",function(){o.disabled=!0,o.innerText="Creando..."})}}const c=document.getElementById("dialog-editar"),E=document.getElementById("btn-cerrar-editar"),r=document.getElementById("form-editar"),l=document.querySelectorAll(".btn-editar-tabla");if(c&&r){l.forEach(o=>{o.addEventListener("click",function(){var y,C,I,v;const t=this.getAttribute("data-id"),s=this.getAttribute("data-nombre"),b=this.getAttribute("data-tamaño"),f=this.getAttribute("data-precio"),h=this.getAttribute("data-stock");(y=document.getElementById("edit-nombre"))==null||y.setAttribute("value",s),(C=document.getElementById("edit-tamaño"))==null||C.setAttribute("value",b),(I=document.getElementById("edit-precio"))==null||I.setAttribute("value",f),(v=document.getElementById("edit-stock"))==null||v.setAttribute("value",h),c.showModal(),r.action=`/productos/${t}`})});const e=r.querySelector('button[type="submit"]');e&&r.addEventListener("submit",function(){e.disabled=!0,e.innerText="Editando..."}),E&&E.addEventListener("click",()=>c.close())}const a=document.getElementById("dialog-eliminar"),p=document.getElementById("btn-cerrar-eliminar"),i=document.getElementById("btn-confirmar-eliminar"),m=document.querySelectorAll(".btn-eliminar-tabla");let g;a&&i&&(m.forEach(e=>{e.addEventListener("click",function(){var f;const o=this.closest("tr"),t=o==null?void 0:o.querySelectorAll("td"),s=((f=t==null?void 0:t[1])==null?void 0:f.innerText)||"nombre no encontrado",b=document.getElementById("mensaje-eliminar");b&&(b.innerText=`¿Estás seguro de que deseas eliminar el producto "${s}"?`),a.showModal(),g=this.getAttribute("data-id")})}),i.addEventListener("click",function(){var o;i.disabled=!0,i.innerText="Eliminando...";const e=(o=document.querySelector('meta[name="csrf-token"]'))==null?void 0:o.getAttribute("content");fetch(`/productos/${g}`,{method:"DELETE",headers:{"X-CSRF-TOKEN":e||""}}).then(t=>{t.ok?location.reload():alert("Error al eliminar el producto.")}).catch(t=>{console.error("Error:",t),alert("Hubo un problema con la eliminación. "+t.message)})}),p&&p.addEventListener("click",()=>a.close()))});
